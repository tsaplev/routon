(this["webpackJsonpapp-v3"]=this["webpackJsonpapp-v3"]||[]).push([[0],{27:function(e,t,n){},28:function(e,t,n){},37:function(e,t,n){},38:function(e,t,n){"use strict";n.r(t);var o=n(0),r=n.n(o),a=n(15),i=n.n(a),l=(n(27),n(28),n(5)),c=n(6),s=n(2),u=n.n(s),d=n(4),b=n(13),p=n(3),j=n(10),g=n(11),m={plane:{label:"Plane",icon:"\u2708\ufe0f",travelMode:"OTHER"},car:{label:"Car",icon:"\ud83d\ude98",travelMode:"DRIVING"},bus:{label:"Bus",icon:"\ud83d\ude8d",travelMode:"DRIVING"},train:{label:"Train",icon:"\ud83d\ude86",travelMode:"TRANSIT"},ship:{label:"Ship",icon:"\ud83d\udea2",travelMode:"OTHER"},other:{label:"Other",icon:"\u27a1",travelMode:"OTHER"}},f=function(){function e(){Object(j.a)(this,e)}return Object(g.a)(e,null,[{key:"getPath",value:function(){var e=Object(d.a)(u.a.mark((function e(t,n,o){var r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[t,n],"OTHER"!==(a=m[o].travelMode)){e.next=4;break}return e.abrupt("return",r);case 4:return e.abrupt("return",new Promise((function(e,o){var i=new google.maps.DirectionsService,l={origin:t,destination:n,travelMode:google.maps.TravelMode[a]};i.route(l,(function(t,n){var a;if("OK"!==n)return console.error("Directions request failed due to:"+n),o(r);if(null===t||void 0===t||null===(a=t.routes[0])||void 0===a?void 0:a.overview_path){var i=t.routes[0].overview_path.reduce((function(e,t){return[].concat(Object(p.a)(e),[{lat:t.lat(),lng:t.lng()}])}),[]);return e(i)}return r}))})));case 5:case"end":return e.stop()}}),e)})));return function(t,n,o){return e.apply(this,arguments)}}()}]),e}(),h={isLoading:!1,routes:[{id:"nYw34AOsYpJG5BXHfXQzx",departure:"2019-10-16 01:10:00",arrival:"2019-10-16 07:30:00",from:{name:"Moscow",lat:55.7558,lng:37.6173},to:{name:"Dubai",lat:25.2048,lng:55.2708},transport:"plane",path:[{lat:55.7558,lng:37.6173},{lat:25.2048,lng:55.2708}]},{id:"Sy0BEfPNO3EiyUuzc2x6U",departure:"2019-10-16 01:10:00",arrival:"2019-10-16 07:30:00",from:{name:"Dubai",lat:55.7558,lng:37.6173},to:{name:"Manila",lat:14.5995,lng:120.9842},transport:"plane",path:[{lat:25.2048,lng:55.2708},{lat:14.5995,lng:120.9842}]}]},v=Object(b.b)("route/addRoute",function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.getPath(t.from,t.to,t.transport);case 2:return t.path=e.sent,console.log("Route",t),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),O=Object(b.c)({name:"route",initialState:h,reducers:{deleteLastRoute:function(e){e.routes=e.routes.slice(0,-1)},deleteAllRoutes:function(e){e.routes=[]}},extraReducers:function(e){e.addCase(v.pending,(function(e){e.isLoading=!0})),e.addCase(v.fulfilled,(function(e,t){var n=t.payload;e.routes.push(n),e.isLoading=!1})),e.addCase(v.rejected,(function(e){e.isLoading=!1}))}}),x=O.actions,w=x.deleteLastRoute,y=x.deleteAllRoutes,C=function(e){return e.route.routes},k=function(e){return e.route.isLoading},M=O.reducer,S=n(1);function L(){var e=Object(c.c)(C);Object(o.useEffect)((function(){console.log("Component did mount");var n=new google.maps.Map(document.getElementById("map"),{zoom:2.3,center:{lat:50,lng:80},mapTypeId:"terrain",disableDefaultUI:!0,zoomControl:!0});t(n,e)}),[e]);var t=function(e,t){var n=new google.maps.LatLngBounds,o={path:google.maps.SymbolPath.CIRCLE,fillColor:"red",fillOpacity:1,scale:10,strokeColor:"white",strokeWeight:1};t.forEach((function(t,r){var a=new google.maps.LatLng(t.path[0].lat,t.path[0].lng),i=new google.maps.LatLng(t.path[1].lat,t.path[1].lng),c={map:e,label:{text:String(r+1),color:"white"},icon:o};new google.maps.Marker(Object(l.a)(Object(l.a)({},c),{},{position:a})),n.extend(a),new google.maps.Polyline({map:e,path:t.path,geodesic:!0,strokeColor:"#FF0000",strokeOpacity:1,strokeWeight:2}),new google.maps.Marker(Object(l.a)(Object(l.a)({},c),{},{position:i})),n.extend(i),n.isEmpty()||e.fitBounds(n)}))};return Object(S.jsxs)("div",{className:"dbg-box",children:[Object(S.jsx)("h2",{children:"Map"}),Object(S.jsx)("div",{id:"map",style:{height:"500px"}})]})}function R(){var e=Object(c.c)(C),t=Object(c.b)();return Object(S.jsxs)("div",{className:"table dbg-box",children:[Object(S.jsx)("h2",{children:"List"}),e.map((function(e){var t={id:e.id,from:e.from.name,to:e.to.name,by:e.transport};return Object(S.jsx)("pre",{style:{background:"lightgray"},children:Object(S.jsx)("p",{children:JSON.stringify(t,null,2)})},t.id)})),Object(S.jsx)("button",{onClick:function(){return t(w())},children:"Delete"}),Object(S.jsx)("button",{onClick:function(){return t(y())},children:"Delete all"})]})}var E=n(7),N=n(22),B=n(19),I=n(21);n(36),n(37);function T(){var e,t=Object(c.c)(k),n=Object(c.c)(C),o=Object(c.b)(),r=Object(I.a)({mode:"onSubmit",shouldFocusError:!1,reValidateMode:"onBlur"}),a=r.register,i=r.handleSubmit,s=r.setValue,u=r.reset,d=r.formState.errors;if(t)return Object(S.jsxs)("div",{className:"dbg-box",children:[Object(S.jsx)("h2",{children:"Form"}),Object(S.jsx)("h2",{children:"Calculating shortest path..."})]});var b=function(){var e,t=null===(e=n[n.length-1])||void 0===e?void 0:e.to;return t?{required:!(t.name.length>0),value:{gmaps:{name:t.name},location:{lat:t.lat,lng:t.lng}}}:{required:!0,value:null}}();return Object(S.jsxs)("div",{className:"dbg-box",children:[Object(S.jsx)("h2",{children:"Form"}),Object(S.jsxs)("form",{autoComplete:"off",onSubmit:i((function(e){var t,n,r,a,i,l;o(v({id:Object(N.a)(),departure:"2019-02-03 14:05",arrival:"2019-02-04 01:23",from:{name:null===(t=e.from.gmaps)||void 0===t?void 0:t.name,lat:null===(n=e.from.location)||void 0===n?void 0:n.lat,lng:null===(r=e.from.location)||void 0===r?void 0:r.lng},to:{name:null===(a=e.to.gmaps)||void 0===a?void 0:a.name,lat:null===(i=e.to.location)||void 0===i?void 0:i.lat,lng:null===(l=e.to.location)||void 0===l?void 0:l.lng},transport:e.transport,path:[]})),u()})),children:[Object(S.jsxs)("div",{className:"dbg-box__input",children:[Object(S.jsx)(B.a,Object(l.a)(Object(l.a)({},a("from",{required:b.required,value:b.value})),{},{initialValue:null===(e=b.value)||void 0===e?void 0:e.gmaps.name,disabled:!b.required,onChange:function(){},onBlur:function(){},onSuggestSelect:function(e){s("from",e)},autoComplete:"off"})),d.from&&Object(S.jsx)("span",{style:{color:"red"},children:" This field is required"})]}),Object(S.jsx)("div",{className:"dbg-box__input",style:{borderColor:d.transport?"red":"transparent"},children:Object(S.jsxs)("select",Object(l.a)(Object(l.a)({},a("transport",{required:!0})),{},{name:"transport",children:[Object(S.jsx)("option",{hidden:!0,label:" -- "}),Object.entries(m).map((function(e){var t=Object(E.a)(e,2),n=t[0],o=t[1];return Object(S.jsx)("option",{value:n,children:o.label},n)}))]}))}),Object(S.jsx)("div",{className:"dbg-box__input",style:{borderColor:d.to?"red":"transparent"},children:Object(S.jsx)(B.a,Object(l.a)(Object(l.a)({},a("to",{required:!0})),{},{onChange:function(){},onBlur:function(){},onSuggestSelect:function(e){s("to",e)},autoComplete:"off"}))}),Object(S.jsx)("button",{type:"submit",children:"Add"})]})]})}var q=function(){return Object(S.jsxs)("div",{className:"layout",children:[Object(S.jsx)(L,{}),Object(S.jsx)(T,{}),Object(S.jsx)(R,{})]})},D=Object(b.a)({reducer:{route:M}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(Object(S.jsx)(r.a.StrictMode,{children:Object(S.jsx)(c.a,{store:D,children:Object(S.jsx)(q,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[38,1,2]]]);
//# sourceMappingURL=main.07a550bb.chunk.js.map